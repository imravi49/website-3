import React, {useState} from 'react';
import DatePicker from 'react-multi-date-picker';
import emailjs from 'emailjs-com';
const EMAILJS_SERVICE = 'service_as2m26q';
const EMAILJS_TEMPLATE = 'template_n5ur429';
const EMAILJS_USER = 'a4-PdJdb-Lp5Vt8_3';
export default function InquiryModal({onClose}){
  const [step,setStep]=useState(1);
  const [name,setName]=useState(''); const [phone,setPhone]=useState(''); const [email,setEmail]=useState(''); const [eventType,setEventType]=useState(''); const [dates,setDates]=useState([]);
  const [requirements,setRequirements]=useState([]); const [special,setSpecial]=useState(''); const [location,setLocation]=useState(''); const [budget,setBudget]=useState(0);
  const toggle = v=> setRequirements(r=> r.includes(v)? r.filter(x=>x!==v): [...r,v]);
  const formatINR = n=> n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
  const send = ()=>{ const payload = {user_name:name,user_phone:phone,user_email:email,event_type:eventType,event_dates:dates.join(','),requirements:requirements.join(','),special,location,budget:formatINR(budget)}; emailjs.send(EMAILJS_SERVICE, EMAILJS_TEMPLATE, payload, EMAILJS_USER).then(()=>{ alert('Inquiry sent'); onClose(); }).catch(()=>{ alert('Failed'); onClose(); }); };
  return (<div className='popup' id='inquiry'><div className='popup-content'><button className='close-x' onClick={onClose}>×</button><h3>Inquiry</h3>{step===1 && (<div><label>Name*</label><input className='input' value={name} onChange={e=>setName(e.target.value)} /><label>Phone*</label><input className='input' value={phone} onChange={e=>setPhone(e.target.value)} /><div style={{display:'flex',justifyContent:'flex-end',gap:8,marginTop:12}}><button className='btn-ghost' onClick={onClose}>Cancel</button><button className='btn-primary' disabled={!(name&&phone)} onClick={()=>setStep(2)}>Next</button></div></div>)}{step===2 && (<div><label>Email*</label><input className='input' value={email} onChange={e=>setEmail(e.target.value)} /><div style={{display:'flex',justifyContent:'space-between',marginTop:8}}><button className='btn-ghost' onClick={()=>setStep(1)}>Back</button><button className='btn-primary' disabled={!email} onClick={()=>setStep(3)}>Next</button></div></div>)}{step===3 && (<div><label>Event Type*</label><select className='input' value={eventType} onChange={e=>setEventType(e.target.value)}><option value=''>Select</option><option value='wedding'>Wedding</option><option value='prewedding'>Prewedding</option><option value='engagement'>Engagement</option><option value='baby shower'>Baby Shower</option><option value='birthday'>Birthday</option><option value='commercial'>Commercial</option><option value='other'>Other</option></select><div style={{display:'flex',justifyContent:'space-between',marginTop:8}}><button className='btn-ghost' onClick={()=>setStep(2)}>Back</button><button className='btn-primary' disabled={!eventType} onClick={()=>setStep(4)}>Next</button></div></div>)}{step===4 && (<div><label>Event Dates</label><DatePicker multiple value={dates} onChange={setDates} format='YYYY-MM-DD' placeholder='Select dates' /><div style={{display:'flex',justifyContent:'space-between',marginTop:8}}><button className='btn-ghost' onClick={()=>setStep(3)}>Back</button><button className='btn-primary' disabled={!dates.length} onClick={()=>setStep(5)}>Next</button></div></div>)}{step===5 && (<div><label>Requirements</label><div className='apple-checkboxes'><label className={requirements.includes('Candid')?'checked':''}><input type='checkbox' onChange={()=>toggle('Candid')} /> Candid Photography</label><label className={requirements.includes('Cine')?'checked':''}><input type='checkbox' onChange={()=>toggle('Cine')} /> Cinematography</label><label className={requirements.includes('Trad')?'checked':''}><input type='checkbox' onChange={()=>toggle('Trad')} /> Traditional Photo / Video</label></div><label>Special Requirements</label><textarea className='input' value={special} onChange={e=>setSpecial(e.target.value)} /><div style={{display:'flex',justifyContent:'space-between',marginTop:8}}><button className='btn-ghost' onClick={()=>setStep(4)}>Back</button><button className='btn-primary' onClick={()=>setStep(6)}>Next</button></div></div>)}{step===6 && (<div><label>Location & Schedule</label><input className='input' value={location} onChange={e=>setLocation(e.target.value)} /><label>Budget (₹)</label><div style={{display:'flex',gap:8,alignItems:'center'}}><input type='range' min='0' max='1000000' value={budget} onChange={e=>setBudget(Number(e.target.value))} /><input className='input' style={{width:160}} value={budget.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',')} onChange={e=>{const v=Number(e.target.value.replace(/,/g,'')); setBudget(isNaN(v)?0:v);}} /></div><div style={{display:'flex',justifyContent:'space-between',marginTop:8}}><button className='btn-ghost' onClick={()=>setStep(5)}>Back</button><button className='btn-primary' onClick={send}>Send Inquiry</button></div></div>)}</div></div>); }